<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bind Wallet | Koozai Digital Agency Marketing</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
     <!-- toastr cdn link for css -->
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.min.css">
    <link href="./assets/css/style.css" rel="stylesheet" />
    <link href="./assets/css/buttons.css" rel="stylesheet" />
    <link href="./assets/css/responsive.css" rel="stylesheet" />
  </head>
  <body class="bg-light-theme">
    <div class="body-wrapper">
      <header class="shadow-sm position-relative">
        <a href="./index.html">
          <img
            src="./assets/images/chevron-back-outline.svg"
            class="pointer"
            width="30px"
          />
        </a>
        <div class="page-title">Bind Wallet</div>
      </header>
      <div class="body-content">
        <div class="row">
          <div class="col-md-12 col-xl-12 col-lg-12 m-auto">
            <p class="text-black-50s">
              Kind Reminder: Every user is only allowed to manually bind the
              wallet address once, if you want to update or change your binding
              address, <br />
              please contact customer service for further assistance.
            </p>
            <!-- <div class="row">
              <div class="col-md-4">
                <div class="box p-0 mb-4">
                  <div class="auth-control-row border-top-0">
                    <span>Full Name</span>
                    <input type="text" placeholder="Type Here" />
                  </div>
                  <div class="auth-control-row border-top-0">
                    <span>Crypto exchange platform</span>
                    <input type="text" placeholder="Type Here" />
                  </div>
                  <div class="auth-control-row border-top-0">
                    <span> USDT TRC20 Address</span>
                    <input type="text" placeholder="Type Here" />
                  </div>
                  <div class="auth-control-row border-top-0 border-bottom-0">
                    <span> Phone No</span>
                    <input type="text" placeholder="Type Here" />
                  </div>
                </div>
                <div class="text-center">
                  <button class="btn btn-theme w-100 btn-lg shadow rounded-3">
                    Confirm
                  </button>
                </div>
              </div>
            </div> -->

            <!-- Loading spinner -->

            <div id="loadingSpinner" class="loader-container d-none">
              <span class="loader"></span>
          </div>"

            <div class="row">
              <div class="col-md-4">
                  <form id="walletForm">
                      <div class="box p-0 mb-4">
                          <div class="auth-control-row border-top-0">
                              <span>Full Name</span>
                              <input type="text" id="full_name" placeholder="Type Here" />
                          </div>
                          <div class="auth-control-row border-top-0">
                              <span>Crypto exchange platform</span>
                              <input type="text" id="crypto_exchange_platform" placeholder="Type Here" />
                          </div>
                          <div class="auth-control-row border-top-0">
                              <span>USDT TRC20 Address</span>
                              <input type="text" id="usdt_trc20_address" placeholder="Type Here" />
                          </div>
                          <div class="auth-control-row border-top-0 border-bottom-0">
                              <span>Phone No</span>
                              <input type="text" id="phone" placeholder="Type Here" />
                          </div>
                      </div>
                      <div class="text-center">
                          <button type="submit" class="btn btn-theme w-100 btn-lg shadow rounded-3">
                              Confirm
                          </button>
                      </div>
                  </form>
              </div>
          </div>
          
          </div>
        </div>
      </div>
    </div>


     <!-- model for success and error messages -->
     <div class="modal fade" id="messageModal" tabindex="-1" aria-labelledby="messageModalLabel" aria-hidden="true" >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content text-white w-auto mx-auto">
          <div class="modal-body show_message bg-dark text-center">
            <p id="messageContent" class="text-center mt-3"></p>
          </div>
        </div>
      </div>
    </div>
    <!-- CDN -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
         <!-- toastr cdn link for js -->
         <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>
         
         <!-- base url file -->
         <script src="./js/integrations/all.js"></script> 
         <script src="./js/integrations/cart_bind.js"></script> 
         <!-- Add this script tag to your HTML file -->
     <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
     

     <!-- <script>

      
// Check if a token is available in localStorage
const auth_token = localStorage.getItem('user_token');

if (!auth_token) {
  // No token is available, so redirect to the login page
  window.location.href = './login.html'; 
}


// Function to parse JWT token
function parseJwt(token) {
  const base64Url = token.split('.')[1];
  const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
  const jsonPayload = decodeURIComponent(
    atob(base64)
      .split('')
      .map(function (c) {
        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
      })
      .join('')
  );

  return JSON.parse(jsonPayload);
}
      // Configure Toastr options
      const toastrOptions = {
          closeButton: true,
          progressBar: true,
          positionClass: 'toast-bottom-right',
      };
  
      $(document).ready(function () {
          // Function to show the loading spinner
          function showLoadingSpinner() {
              $('#loadingSpinner').removeClass('d-none');
          }
  
          // Function to hide the loading spinner
          function hideLoadingSpinner() {
              $('#loadingSpinner').addClass('d-none');
          }
  
          // Handle form submission
          $('#walletForm').submit(function (e) {
              e.preventDefault();
  
              // Get data by their IDs
              const full_name = $('#full_name').val();
              const crypto_exchange_platform = $('#crypto_exchange_platform').val();
              const usdt_trc20_address = $('#usdt_trc20_address').val();
              const phone = $('#phone').val();
  
              // Fetch the user's profile using the bearer token
              const token = localStorage.getItem('user_token');
              const decodedToken = parseJwt(token);
              const userId = decodedToken.userId;
  
              // Prepare data to send
              const data = {
                  user_id: userId,
                  full_name,
                  crypto_exchange_platform,
                  usdt_trc20_address,
                  phone
              };
  
              // Make an AJAX call to bind the wallet
              $.ajax({
                  type: 'POST',
                  url: 'http://localhost:5000/api/bind-wallet',
                  data: JSON.stringify(data),
                  contentType: 'application/json',
                  beforeSend: function (xhr) {
                      // Set the Authorization header with the token
                      xhr.setRequestHeader('Authorization', `Bearer ${token}`);
  
                      // Show loading spinner before the AJAX call
                      showLoadingSpinner();
                  },
                  success: function (response) {
                      // Hide loading spinner when the API request is complete
                      hideLoadingSpinner();
  
                      // Show a success notification using Toastr
                      toastr.success(response.message, "Success", toastrOptions);
                  },
                  error: function (error) {
                    console.log(error)
                      // Hide loading spinner when the API request is complete
                      hideLoadingSpinner();
  
                      // Show an error notification using Toastr
                      toastr.error(error.responseJSON.error, "Error", toastrOptions);
                  }
              });
          });
      });
  </script> -->



  <script>
    // Check if a token is available in localStorage
    const auth_token = localStorage.getItem('user_token');

    if (!auth_token) {
        // No token is available, so redirect to the login page
        window.location.href = './login.html';
    }

    // Function to parse JWT token
    function parseJwt(token) {
        const base64Url = token.split('.')[1];
        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
        const jsonPayload = decodeURIComponent(
            atob(base64)
                .split('')
                .map(function (c) {
                    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
                })
                .join('')
        );

        return JSON.parse(jsonPayload);
    }

    // Configure Toastr options
    const toastrOptions = {
        closeButton: true,
        progressBar: true,
        positionClass: "toast-top-center",
        timeOut: 5000,
        extendedTimeOut: 2000,
        showDuration: 1000,
        hideDuration: 5000,
        preventDuplicates: true,
        newestOnTop: true,
    };

    $(document).ready(function () {
        // Function to show the loading spinner
        function showLoadingSpinner() {
            $('#loadingSpinner').removeClass('d-none');
        }

        // Function to hide the loading spinner
        function hideLoadingSpinner() {
            $('#loadingSpinner').addClass('d-none');
        }

        // Handle form submission
        $('#walletForm').submit(function (e) {
            e.preventDefault();

            // Get data by their IDs
            const full_name = $('#full_name').val();
            const crypto_exchange_platform = $('#crypto_exchange_platform').val();
            const usdt_trc20_address = $('#usdt_trc20_address').val();
            const phone = $('#phone').val();

            // Fetch the user's profile using the bearer token
            const token = localStorage.getItem('user_token');
            const decodedToken = parseJwt(token);
            const userId = decodedToken.userId;

            // Prepare data to send
            const data = {
                user_id: userId,
                full_name,
                crypto_exchange_platform,
                usdt_trc20_address,
                phone
            };

            // Make an AJAX call to bind the wallet
            $.ajax({
                type: 'POST',
                url: 'http://localhost:5000/api/bind-wallet', // Replace with your API endpoint URL
                data: JSON.stringify(data),
                contentType: 'application/json',
                headers: {
                    'Authorization': `Bearer ${token}`,
                },
                beforeSend: function (xhr) {
                    // Show loading spinner before the AJAX call
                    showLoadingSpinner();
                },
                success: function (response) {
                    // Hide loading spinner when the API request is complete
                    hideLoadingSpinner();

                    // Show a success notification using Toastr
                    toastr.success(response.message, "Success", toastrOptions);
                },
                error: function (error) {
                    // Hide loading spinner when the API request is complete
                    hideLoadingSpinner();

                    // Show an error notification using Toastr
                    toastr.error(error.responseJSON.error, "Error", toastrOptions);
                }
            });
        });
    });
</script>

  >
  </body>
</html>
